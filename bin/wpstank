#!/usr/bin/env node

var program = require('commander')
    , WPStank = require('../src/wpstank')
    , stank = new WPStank ;

// colors
var red   = '\033[31m'
    , yellow = '\033[33m'
    , black  = '\030[0m'
    , reset  = '\033[0m'
    , b      = ' \r\n'
    , space  = '    ';

// helper functions 
var list = function( val ) {
    return val.split( ',' );
}

var error = function( msg ) { console.log( red + msg + reset ); }
var warning = function( msg ) { console.log( yellow + msg + reset ); }
var log = function( msg ) { console.log( b + space + msg + reset ); }

program
    .version('0.0.0')
    .option('-g, --generate', 'Generate a file')
    .option('-d, --destroy', 'Delete a file')
    .option('-p, --post-type [type]', 'Post Type')
    .option('-s, --shortcode [type]', 'Shortcode')
    .option('-t, --taxonomy [type]', 'Taxonomy');

program
    .command('init')
    .description('Setup stank')
    .action(function(){
        console.log( "initializing..." );
        stank.init();
    });

program.parse( process.argv );

// The main post types
var types = [ 'postType', 'taxonomy', 'shortcode' ];

for( i = 0; i < types.length; i++ ) {
    var type = types[i];
    if( program[type] ) {
        // Is a type specified?
        if( program[type] === true ) return console.log( "No " + type + " was specified" );
        if( program.generate ) stank.create( program[type], type ); 
        if( program.destroy ) stank.destroy( program[type], type ); 
    }
}
